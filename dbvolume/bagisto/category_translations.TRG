TYPE=TRIGGERS
triggers='CREATE DEFINER=`bagisto_user`@`%` TRIGGER trig_category_translations_insert\n            BEFORE INSERT ON category_translations\n            FOR EACH ROW\n            BEGIN\n                            DECLARE parentUrlPath varchar(255);\n            DECLARE urlPath varchar(255);\n\n            IF NOT EXISTS (\n                SELECT id\n                FROM categories\n                WHERE\n                    id = NEW.category_id\n                    AND parent_id IS NULL\n            )\n            THEN\n\n                SELECT\n                    GROUP_CONCAT(parent_translations.slug SEPARATOR \'/\') INTO parentUrlPath\n                FROM\n                    categories AS node,\n                    categories AS parent\n                    JOIN category_translations AS parent_translations ON parent.id = parent_translations.category_id\n                WHERE\n                    node._lft >= parent._lft\n                    AND node._rgt <= parent._rgt\n                    AND node.id = (SELECT parent_id FROM categories WHERE id = NEW.category_id)\n                    AND node.parent_id IS NOT NULL\n                    AND parent.parent_id IS NOT NULL\n                    AND parent_translations.locale = NEW.locale\n                GROUP BY\n                    node.id;\n\n                IF parentUrlPath IS NULL\n                THEN\n                    SET urlPath = NEW.slug;\n                ELSE\n                    SET urlPath = concat(parentUrlPath, \'/\', NEW.slug);\n                END IF;\n\n                SET NEW.url_path = urlPath;\n\n            END IF;\n            END' 'CREATE DEFINER=`bagisto_user`@`%` TRIGGER trig_category_translations_update\n            BEFORE UPDATE ON category_translations\n            FOR EACH ROW\n            BEGIN\n                            DECLARE parentUrlPath varchar(255);\n            DECLARE urlPath varchar(255);\n\n            IF NOT EXISTS (\n                SELECT id\n                FROM categories\n                WHERE\n                    id = NEW.category_id\n                    AND parent_id IS NULL\n            )\n            THEN\n\n                SELECT\n                    GROUP_CONCAT(parent_translations.slug SEPARATOR \'/\') INTO parentUrlPath\n                FROM\n                    categories AS node,\n                    categories AS parent\n                    JOIN category_translations AS parent_translations ON parent.id = parent_translations.category_id\n                WHERE\n                    node._lft >= parent._lft\n                    AND node._rgt <= parent._rgt\n                    AND node.id = (SELECT parent_id FROM categories WHERE id = NEW.category_id)\n                    AND node.parent_id IS NOT NULL\n                    AND parent.parent_id IS NOT NULL\n                    AND parent_translations.locale = NEW.locale\n                GROUP BY\n                    node.id;\n\n                IF parentUrlPath IS NULL\n                THEN\n                    SET urlPath = NEW.slug;\n                ELSE\n                    SET urlPath = concat(parentUrlPath, \'/\', NEW.slug);\n                END IF;\n\n                SET NEW.url_path = urlPath;\n\n            END IF;\n            END'
sql_modes=1073741824 1073741824
definers='bagisto_user@%' 'bagisto_user@%'
client_cs_names='utf8mb4' 'utf8mb4'
connection_cl_names='utf8mb4_unicode_ci' 'utf8mb4_unicode_ci'
db_cl_names='latin1_swedish_ci' 'latin1_swedish_ci'
created=164668884478 164668884482
